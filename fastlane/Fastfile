# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

# Uncomment the line if you want fastlane to automatically update itself
# update_fastlane

platform :ios do
    ios_dir = File.expand_path('../ios')

    lane :test do
        run_tests(
            workspace: File.join(ios_dir, "App/App.xcworkspace")
        )
    end
end

platform :android do
    android_dir = File.expand_path('../android')

    # desc "Runs all the tests"
    # lane :test do
    #     gradle(task: "test")
    # end

    # desc "Submit a new Beta Build to Crashlytics Beta"
    # lane :beta do
    #     gradle(task: "clean assembleRelease")
    #     crashlytics
    
    #     # sh "your_script.sh"
    #     # You can also use other beta testing services here
    # end

    lane :buildBundle do
        gradle(task: 'clean', project_dir: android_dir)
        gradle(
            task: "bundleRelease", 
            project_dir: android_dir,
            # properties: {
            #     "android.injected.signing.store.file" => File.join(Dir.pwd, "..", "keystore.jks"),
            #     "android.injected.signing.store.password" => ENV["KEYSTORE_PASSWORD"],
            #     "android.injected.signing.key.alias" => ENV["KEYSTORE_ALIAS"],
            #     "android.injected.signing.key.password" => ENV["KEYSTORE_PASSWORD"],
            # }
        )
    end

    # desc "Deploy a new version to the Google Play"
    # lane :deploy do
    #     gradle(task: "clean assembleRelease")
    #     upload_to_play_store
    # end
end